{% extends "base.html" %}

{% block title %}Porte 9 - Divin{% endblock %}

{% block content %}
<div class="portal-page portal-9">
    <header class="portal-header">
        <h1>DIVIN</h1>
        <div class="portal-number">9</div>
        <p class="subtitle">La source primordiale</p>
        <p class="principle-quote">« Tout provient de l'Un et y retourne. L'ultime mystère n'est ni au-dessus, ni au-delà, mais au cœur même de chaque manifestation. Cherche le Tout dans chaque partie. »</p>
    </header>

    <div class="portal-content">
        <div class="wisdom-section">
            <h2>L'Essence de l'Unité</h2>
            <p>Le Divin est le principe ultime qui embrasse et transcende tous les autres. C'est l'origine et la destination de toutes choses, la source infinie de potentialités et le point où tous les opposés se réconcilient. En lui, la multiplicité se fond dans l'unité et le cercle de la création s'accomplit.</p>
            
            <div class="sacred-geometry">
                <div class="divine-container">
                    <div class="enneagram" id="sacredEnneagram">
                        <svg viewBox="0 0 100 100" class="enneagram-symbol">
                            <circle cx="50" cy="50" r="40" fill="none" stroke="currentColor" stroke-width="1"/>
                            <circle cx="50" cy="50" r="3" fill="currentColor" class="center-point"/>
                            
                            <!-- Les neuf points du cercle -->
                            <circle cx="50" cy="10" r="2" fill="currentColor" class="point point-1"/>
                            <circle cx="81.2" cy="25" r="2" fill="currentColor" class="point point-2"/>
                            <circle cx="85.4" cy="59.5" r="2" fill="currentColor" class="point point-3"/>
                            <circle cx="62.5" cy="85.4" r="2" fill="currentColor" class="point point-4"/>
                            <circle cx="25" cy="85.4" r="2" fill="currentColor" class="point point-5"/>
                            <circle cx="14.6" cy="59.5" r="2" fill="currentColor" class="point point-6"/>
                            <circle cx="18.8" cy="25" r="2" fill="currentColor" class="point point-7"/>
                            <circle cx="50" cy="50" r="2" fill="currentColor" class="point point-8"/>
                            <circle cx="50" cy="50" r="2" fill="currentColor" class="point point-9"/>
                            
                            <!-- Lignes connectant les points -->
                            <path d="M 50 10 L 81.2 25 L 85.4 59.5 L 62.5 85.4 L 25 85.4 L 14.6 59.5 L 18.8 25 L 50 10" 
                                 stroke="currentColor" stroke-width="1" fill="none" class="outer-path"/>
                            <path d="M 50 10 L 62.5 85.4 L 18.8 25 L 85.4 59.5 L 14.6 59.5 L 81.2 25 L 25 85.4 L 50 10" 
                                 stroke="currentColor" stroke-width="1" fill="none" class="inner-path"/>
                        </svg>
                    </div>
                    <div class="divine-pulse"></div>
                </div>
            </div>
            
            <div class="principles">
                <h3>Les Neuf Attributs</h3>
                <ul>
                    <li>L'Unité Transcendante</li>
                    <li>L'Amour Inconditionnel</li>
                    <li>La Conscience Éveillée</li>
                    <li>La Création Continuelle</li>
                    <li>La Présence Éternelle</li>
                    <li>La Perfection Inhérente</li>
                    <li>L'Infinité Incarnée</li>
                    <li>La Sagesse Absolue</li>
                    <li>La Plénitude Ultime</li>
                </ul>
            </div>
        </div>

        <div class="practice-section">
            <div class="meditation-card">
                <h2>Méditation de l'Unité</h2>
                <p class="meditation-text">Considère chaque inspiration comme l'univers entrant en toi, et chaque expiration comme toi te diffusant dans l'univers. Il n'y a pas d'intérieur ni d'extérieur, juste une seule respiration cosmique.</p>
                <div class="meditation-controls">
                    <button id="startMeditation" class="sacred-button">
                        <i class="fas fa-dharmachakra"></i> Commencer la Méditation
                    </button>
                    <div class="timer-container">
                        <div id="timer" class="timer">09:99</div>
                        <div class="unity-indicator">
                            <div class="unity-circle">
                                <div class="unity-ripple"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="exercise-card">
                <h2>Pratique du Divin</h2>
                <p class="exercise-text">Pour chacune des huit portes précédentes, identifie comment ce principe se manifeste dans ta vie quotidienne. Puis, trouve comment tous ces principes s'unissent en un tout cohérent, formant une seule sagesse.</p>
                <div class="exercise-controls">
                    <button id="startExercise" class="sacred-button">
                        <i class="fas fa-infinity"></i> Démarrer l'Exercice
                    </button>
                    <div id="exerciseTimer" class="timer">05:00</div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
:root {
    --portal-color: #9933CC;
    --portal-color-light: rgba(153, 51, 204, 0.3);
    --portal-color-fade: rgba(153, 51, 204, 0.1);
    --portal-color-glow: rgba(153, 51, 204, 0.2);
}

.portal-page {
    max-width: 1000px;
    margin: 0 auto;
    padding: 2rem;
    position: relative;
    background: radial-gradient(circle at center, var(--portal-color-fade) 0%, transparent 70%);
}

.portal-page::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, var(--portal-color-fade) 0%, transparent 50%, var(--portal-color-fade) 100%);
    pointer-events: none;
    z-index: -1;
}

.portal-header {
    text-align: center;
    margin-bottom: 4rem;
    position: relative;
    padding: 2rem;
    background: linear-gradient(to bottom, var(--portal-color-fade), transparent);
    border-radius: 20px;
    box-shadow: 0 0 30px var(--portal-color-glow);
}

.portal-header h1 {
    font-size: 3.5rem;
    background: linear-gradient(to bottom, var(--portal-color), rgba(153, 51, 204, 0.7));
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    margin: 0;
    letter-spacing: 0.5rem;
    font-weight: 400;
    text-shadow: 0 0 20px var(--portal-color-glow);
}

.portal-number {
    font-size: 12rem;
    background: linear-gradient(135deg, var(--portal-color-light), var(--portal-color-fade));
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    position: absolute;
    top: -3rem;
    left: 50%;
    transform: translateX(-50%);
    z-index: -1;
    text-shadow: 0 0 50px var(--portal-color-glow);
}

.subtitle {
    font-size: 1.5rem;
    color: var(--color-pearl);
    margin: 1rem 0;
    font-style: italic;
}

.principle-quote {
    font-size: 1.2rem;
    color: var(--portal-color);
    max-width: 700px;
    margin: 2rem auto;
    font-style: italic;
    line-height: 1.6;
}

.wisdom-section {
    margin-bottom: 4rem;
    text-align: center;
    padding: 2rem;
    background: linear-gradient(to bottom, rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.2));
    border-radius: 20px;
    box-shadow: 0 0 30px rgba(0, 0, 0, 0.3);
    border: 1px solid var(--portal-color-fade);
}

.sacred-geometry {
    height: 200px;
    margin: 3rem 0;
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    background: radial-gradient(circle at center, var(--portal-color-fade) 0%, transparent 70%);
}

.divine-container {
    position: relative;
    width: 150px;
    height: 150px;
}

.enneagram {
    position: absolute;
    width: 100%;
    height: 100%;
    color: var(--portal-color);
    cursor: pointer;
    transition: all 1s ease;
    transform-origin: center;
}

.enneagram:hover {
    filter: brightness(1.3);
}

.center-point {
    transition: all 0.3s ease;
}

.enneagram:hover .center-point {
    r: 5;
    filter: drop-shadow(0 0 5px var(--portal-color));
}

.point {
    transition: all 0.5s ease;
}

.enneagram:hover .point {
    r: 3;
    filter: drop-shadow(0 0 3px var(--portal-color));
}

.outer-path {
    transition: all 0.5s ease;
    stroke-dasharray: 300;
    stroke-dashoffset: 300;
    animation: dash 4s linear forwards infinite;
}

.inner-path {
    transition: all 0.5s ease;
    stroke-dasharray: 500;
    stroke-dashoffset: 500;
    animation: dash 6s linear forwards infinite;
    animation-delay: 2s;
}

@keyframes dash {
    to {
        stroke-dashoffset: 0;
    }
}

.divine-pulse {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 80px;
    height: 80px;
    border-radius: 50%;
    background: radial-gradient(circle at center, var(--portal-color-light) 0%, transparent 70%);
    opacity: 0.5;
    animation: pulse 3s infinite ease-in-out;
}

@keyframes pulse {
    0% {
        transform: translate(-50%, -50%) scale(0.8);
        opacity: 0.2;
    }
    50% {
        transform: translate(-50%, -50%) scale(1.2);
        opacity: 0.5;
    }
    100% {
        transform: translate(-50%, -50%) scale(0.8);
        opacity: 0.2;
    }
}

.principles {
    margin-top: 3rem;
    padding: 2rem;
    background: linear-gradient(135deg, rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.2));
    border-radius: 15px;
    border: 1px solid var(--portal-color-fade);
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
}

.principles h3 {
    color: var(--portal-color);
    margin-bottom: 1.5rem;
    font-size: 1.3rem;
}

.principles ul {
    list-style: none;
    padding: 0;
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem;
}

.principles li {
    color: var(--color-pearl);
    padding: 0.5rem;
    font-size: 1.1rem;
}

.practice-section {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 2rem;
}

.meditation-card, .exercise-card {
    background: linear-gradient(135deg, rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.2));
    border: 1px solid var(--portal-color-fade);
    border-radius: 15px;
    padding: 2rem;
    text-align: center;
    box-shadow: 0 0 30px rgba(0, 0, 0, 0.3);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.meditation-card:hover, .exercise-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 5px 40px var(--portal-color-glow);
}

.meditation-card h2, .exercise-card h2 {
    color: var(--portal-color);
    font-size: 1.5rem;
    margin-bottom: 1.5rem;
}

.meditation-text, .exercise-text {
    color: var(--color-pearl);
    font-size: 1.1rem;
    line-height: 1.6;
    margin-bottom: 2rem;
}

.sacred-button {
    background: linear-gradient(135deg, var(--portal-color-light), var(--portal-color-fade));
    border: 1px solid var(--portal-color);
    color: var(--color-pearl);
    padding: 1rem 2rem;
    font-size: 1.1rem;
    border-radius: 30px;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-bottom: 1rem;
    box-shadow: 0 0 20px var(--portal-color-glow);
    text-shadow: 0 0 10px var(--portal-color-glow);
}

.sacred-button:hover {
    background: linear-gradient(135deg, var(--portal-color-light), var(--portal-color-fade));
    transform: translateY(-2px);
    box-shadow: 0 5px 30px var(--portal-color);
    color: white;
}

.timer {
    font-size: 2.5rem;
    background: linear-gradient(to bottom, var(--portal-color), rgba(153, 51, 204, 0.7));
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    margin: 1rem 0;
    font-family: 'Courier New', monospace;
    text-shadow: 0 0 10px var(--portal-color-glow);
}

.unity-indicator {
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 1rem 0;
}

.unity-circle {
    position: relative;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    border: 1px solid var(--portal-color);
    background-color: var(--portal-color-fade);
    display: flex;
    justify-content: center;
    align-items: center;
    transition: all 0.5s ease;
}

.unity-ripple {
    position: absolute;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    border: 1px solid var(--portal-color);
    animation: unity-ripple 4s infinite;
}

@keyframes unity-ripple {
    0% {
        transform: scale(0);
        opacity: 1;
    }
    100% {
        transform: scale(2);
        opacity: 0;
    }
}

@media (max-width: 768px) {
    .practice-section {
        grid-template-columns: 1fr;
    }
    
    .principles ul {
        grid-template-columns: 1fr;
    }
}
</style>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Ennéagramme divin interactif
    const enneagram = document.getElementById('sacredEnneagram');
    const points = document.querySelectorAll('.point');
    let rotationInterval;
    let rotationAngle = 0;
    
    enneagram.addEventListener('click', function() {
        if (rotationInterval) {
            clearInterval(rotationInterval);
            rotationInterval = null;
            this.style.transform = 'rotate(0deg)';
        } else {
            // Rotation lente et continue
            rotationInterval = setInterval(() => {
                rotationAngle = (rotationAngle + 0.5) % 360;
                this.style.transform = `rotate(${rotationAngle}deg)`;
            }, 50);
        }
        
        // Animation des points
        points.forEach((point, index) => {
            setTimeout(() => {
                point.style.filter = 'drop-shadow(0 0 5px var(--portal-color))';
                point.style.r = '3';
                
                setTimeout(() => {
                    point.style.filter = '';
                    point.style.r = '2';
                }, 500);
            }, index * 100);
        });
    });
    
    // Méditation de l'unité
    const meditationButton = document.getElementById('startMeditation');
    const timer = document.getElementById('timer');
    const unityCircle = document.querySelector('.unity-circle');
    let meditationInterval;
    let breathInterval;
    let isMeditating = false;
    let timeLeft = 9 * 60 + 9; // 9:09
    let isExpanding = true;

    meditationButton.addEventListener('click', function() {
        isMeditating = !isMeditating;
        
        if (isMeditating) {
            this.innerHTML = '<i class="fas fa-pause"></i> Pause';
            startMeditation();
            startBreathAnimation();
        } else {
            this.innerHTML = '<i class="fas fa-play"></i> Reprendre';
            pauseMeditation();
        }
    });

    function startMeditation() {
        meditationInterval = setInterval(() => {
            timeLeft--;
            updateTimer(timer, timeLeft);
            
            if (timeLeft <= 0) {
                endMeditation();
            }
        }, 1000);
    }
    
    function startBreathAnimation() {
        let size = 1;
        let direction = 0.05;
        
        breathInterval = setInterval(() => {
            size += direction;
            
            if (size >= 1.5 || size <= 0.8) {
                direction *= -1;
            }
            
            unityCircle.style.transform = `scale(${size})`;
            unityCircle.style.opacity = size > 1.2 ? 2 - size : size;
        }, 100);
    }

    function pauseMeditation() {
        clearInterval(meditationInterval);
        clearInterval(breathInterval);
    }

    function endMeditation() {
        clearInterval(meditationInterval);
        clearInterval(breathInterval);
        meditationButton.innerHTML = '<i class="fas fa-redo"></i> Recommencer';
        isMeditating = false;
        timeLeft = 9 * 60 + 9;
        updateTimer(timer, timeLeft);
        unityCircle.style.transform = 'scale(1)';
        unityCircle.style.opacity = '1';
        new Audio('/static/audio/bell.mp3').play();
    }

    // Exercice
    const exerciseButton = document.getElementById('startExercise');
    const exerciseTimer = document.getElementById('exerciseTimer');
    let exerciseInterval;
    let isExercising = false;
    let exerciseTimeLeft = 9 * 60; // 9:00

    exerciseButton.addEventListener('click', function() {
        isExercising = !isExercising;
        
        if (isExercising) {
            this.innerHTML = '<i class="fas fa-pause"></i> Pause';
            startExercise();
        } else {
            this.innerHTML = '<i class="fas fa-play"></i> Reprendre';
            pauseExercise();
        }
    });

    function startExercise() {
        exerciseInterval = setInterval(() => {
            exerciseTimeLeft--;
            updateTimer(exerciseTimer, exerciseTimeLeft);
            
            if (exerciseTimeLeft <= 0) {
                endExercise();
            }
        }, 1000);
    }

    function pauseExercise() {
        clearInterval(exerciseInterval);
    }

    function endExercise() {
        clearInterval(exerciseInterval);
        exerciseButton.innerHTML = '<i class="fas fa-redo"></i> Recommencer';
        isExercising = false;
        exerciseTimeLeft = 9 * 60;
        updateTimer(exerciseTimer, exerciseTimeLeft);
        new Audio('/static/audio/bell.mp3').play();
    }

    // Utilitaire pour formater le temps
    function updateTimer(element, seconds) {
        const minutes = Math.floor(seconds / 60);
        const remainingSeconds = seconds % 60;
        element.textContent = `${minutes}:${remainingSeconds.toString().padStart(2, '0')}`;
    }
    
    // Créer des ondulations aléatoires pour l'effet divin
    function createRipple() {
        const ripple = document.createElement('div');
        ripple.classList.add('unity-ripple');
        document.querySelector('.unity-circle').appendChild(ripple);
        
        setTimeout(() => {
            ripple.remove();
        }, 4000);
        
        setTimeout(createRipple, Math.random() * 2000 + 1000);
    }
    
    createRipple();
});
</script>
{% endblock %}