{% extends "base.html" %}

{% block title %}Porte 6 - Causalité{% endblock %}

{% block content %}
<div class="portal-page portal-6">
    <header class="portal-header">
        <h1>CAUSALITÉ</h1>
        <div class="portal-number">6</div>
        <p class="subtitle">La loi des conséquences</p>
        <p class="principle-quote">« Chaque action engendre une réaction. Chaque graine semée détermine la récolte. Dans la chaîne infinie des causes et des effets, trouve où placer ton intention. »</p>
    </header>

    <div class="portal-content">
        <div class="wisdom-section">
            <h2>L'Art de la Conséquence</h2>
            <p>La Causalité est la loi universelle qui relie toute action à ses conséquences. Elle nous enseigne que rien n'arrive par hasard, que tout effet a une cause précédente, et que chaque choix crée une onde d'influence se propageant à travers le temps et l'espace.</p>
            
            <div class="sacred-geometry">
                <div class="causality-container">
                    <div class="hexagon" id="causalityHexagon">
                        <svg viewBox="0 0 100 100" class="hexagon-symbol">
                            <polygon points="50,10 90,30 90,70 50,90 10,70 10,30" stroke="currentColor" stroke-width="2" fill="none"/>
                            <circle cx="50" cy="50" r="2" fill="currentColor" class="center-point"/>
                            <g id="causalityLines">
                                <line x1="50" y1="50" x2="50" y2="10" stroke="currentColor" stroke-width="1" class="causality-line"/>
                                <line x1="50" y1="50" x2="90" y2="30" stroke="currentColor" stroke-width="1" class="causality-line"/>
                                <line x1="50" y1="50" x2="90" y2="70" stroke="currentColor" stroke-width="1" class="causality-line"/>
                                <line x1="50" y1="50" x2="50" y2="90" stroke="currentColor" stroke-width="1" class="causality-line"/>
                                <line x1="50" y1="50" x2="10" y2="70" stroke="currentColor" stroke-width="1" class="causality-line"/>
                                <line x1="50" y1="50" x2="10" y2="30" stroke="currentColor" stroke-width="1" class="causality-line"/>
                            </g>
                        </svg>
                    </div>
                    <div class="causality-drops">
                        <div class="ripple-circle"></div>
                    </div>
                </div>
            </div>
            
            <div class="principles">
                <h3>Les Six Principes</h3>
                <ul>
                    <li>L'Intention Originelle</li>
                    <li>La Chaîne des Événements</li>
                    <li>Les Conséquences Invisibles</li>
                    <li>La Responsabilité Créatrice</li>
                    <li>L'Équilibre Karmique</li>
                    <li>La Transformation Consciente</li>
                </ul>
            </div>
        </div>

        <div class="practice-section">
            <div class="meditation-card">
                <h2>Méditation de la Cause à l'Effet</h2>
                <p class="meditation-text">Remonte le fil de tes pensées jusqu'à leur origine. Observe comment une pensée a mené à une autre, puis à une émotion, puis à une action. Vois la chaîne des causes et des effets en toi-même.</p>
                <div class="meditation-controls">
                    <button id="startMeditation" class="sacred-button">
                        <i class="fas fa-link"></i> Commencer la Méditation
                    </button>
                    <div class="timer-container">
                        <div id="timer" class="timer">06:66</div>
                        <div class="causality-indicator">
                            <div class="causality-chain">
                                <span class="chain-link">Pensée</span>
                                <span class="chain-arrow">→</span>
                                <span class="chain-link">Émotion</span>
                                <span class="chain-arrow">→</span>
                                <span class="chain-link">Action</span>
                                <span class="chain-arrow">→</span>
                                <span class="chain-link">Effet</span>
                            </div>
                        </div>
                    </div>
                </div>
        </div>

            <div class="exercise-card">
                <h2>Pratique de la Causalité</h2>
                <p class="exercise-text">Identifie un domaine de ta vie où tu souhaites un changement. Remonte aux causes fondamentales et non aux symptômes. Quelles habitudes, croyances ou actions sont à l'origine de ta situation actuelle? Change la cause, et l'effet suivra.</p>
                <div class="exercise-controls">
                    <button id="startExercise" class="sacred-button">
                        <i class="fas fa-sitemap"></i> Démarrer l'Exercice
                    </button>
                    <div id="exerciseTimer" class="timer">05:00</div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
:root {
    --portal-color: #3399FF;
    --portal-color-light: rgba(51, 153, 255, 0.3);
    --portal-color-fade: rgba(51, 153, 255, 0.1);
    --portal-color-glow: rgba(51, 153, 255, 0.2);
}

.portal-page {
    max-width: 1000px;
    margin: 0 auto;
    padding: 2rem;
    position: relative;
    background: radial-gradient(circle at center, var(--portal-color-fade) 0%, transparent 70%);
}

.portal-page::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, var(--portal-color-fade) 0%, transparent 50%, var(--portal-color-fade) 100%);
    pointer-events: none;
    z-index: -1;
}

.portal-header {
    text-align: center;
    margin-bottom: 4rem;
    position: relative;
    padding: 2rem;
    background: linear-gradient(to bottom, var(--portal-color-fade), transparent);
    border-radius: 20px;
    box-shadow: 0 0 30px var(--portal-color-glow);
}

.portal-header h1 {
    font-size: 3.5rem;
    background: linear-gradient(to bottom, var(--portal-color), rgba(51, 153, 255, 0.7));
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    margin: 0;
    letter-spacing: 0.5rem;
    font-weight: 400;
    text-shadow: 0 0 20px var(--portal-color-glow);
}

.portal-number {
    font-size: 12rem;
    background: linear-gradient(135deg, var(--portal-color-light), var(--portal-color-fade));
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    position: absolute;
    top: -3rem;
    left: 50%;
    transform: translateX(-50%);
    z-index: -1;
    text-shadow: 0 0 50px var(--portal-color-glow);
}

.subtitle {
    font-size: 1.5rem;
    color: var(--color-pearl);
    margin: 1rem 0;
    font-style: italic;
}

.principle-quote {
    font-size: 1.2rem;
    color: var(--portal-color);
    max-width: 700px;
    margin: 2rem auto;
    font-style: italic;
    line-height: 1.6;
}

.wisdom-section {
    margin-bottom: 4rem;
    text-align: center;
    padding: 2rem;
    background: linear-gradient(to bottom, rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.2));
    border-radius: 20px;
    box-shadow: 0 0 30px rgba(0, 0, 0, 0.3);
    border: 1px solid var(--portal-color-fade);
}

.sacred-geometry {
    height: 200px;
    margin: 3rem 0;
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    background: radial-gradient(circle at center, var(--portal-color-fade) 0%, transparent 70%);
}

.causality-container {
    position: relative;
    width: 150px;
    height: 150px;
}

.hexagon {
    position: absolute;
    width: 100%;
    height: 100%;
    color: var(--portal-color);
    cursor: pointer;
    transition: all 0.5s ease;
}

.hexagon:hover {
    filter: brightness(1.3);
}

.causality-line {
    transition: all 0.3s ease;
}

.hexagon:hover .causality-line {
    stroke-width: 2;
    stroke-dasharray: 5, 3;
    animation: dash 2s linear infinite;
}

@keyframes dash {
    to {
        stroke-dashoffset: -8;
    }
}

.center-point {
    transition: all 0.3s ease;
}

.hexagon:hover .center-point {
    r: 4;
    filter: drop-shadow(0 0 5px var(--portal-color));
}

.causality-drops {
    position: absolute;
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    pointer-events: none;
}

.ripple-circle {
    position: absolute;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    border: 2px solid var(--portal-color);
    opacity: 0;
    transform: scale(0);
    animation: ripple 4s infinite;
}

@keyframes ripple {
    0% {
        transform: scale(0);
        opacity: 0;
    }
    20% {
        transform: scale(0.5);
        opacity: 0.8;
    }
    100% {
        transform: scale(2);
        opacity: 0;
    }
}

.principles {
    margin-top: 3rem;
    padding: 2rem;
    background: linear-gradient(135deg, rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.2));
    border-radius: 15px;
    border: 1px solid var(--portal-color-fade);
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
}

.principles h3 {
    color: var(--portal-color);
    margin-bottom: 1.5rem;
    font-size: 1.3rem;
}

.principles ul {
    list-style: none;
    padding: 0;
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem;
}

.principles li {
    color: var(--color-pearl);
    padding: 0.5rem;
    font-size: 1.1rem;
}

.practice-section {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 2rem;
}

.meditation-card, .exercise-card {
    background: linear-gradient(135deg, rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.2));
    border: 1px solid var(--portal-color-fade);
    border-radius: 15px;
    padding: 2rem;
    text-align: center;
    box-shadow: 0 0 30px rgba(0, 0, 0, 0.3);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.meditation-card:hover, .exercise-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 5px 40px var(--portal-color-glow);
}

.meditation-card h2, .exercise-card h2 {
    color: var(--portal-color);
    font-size: 1.5rem;
    margin-bottom: 1.5rem;
}

.meditation-text, .exercise-text {
    color: var(--color-pearl);
    font-size: 1.1rem;
    line-height: 1.6;
    margin-bottom: 2rem;
}

.sacred-button {
    background: linear-gradient(135deg, var(--portal-color-light), var(--portal-color-fade));
    border: 1px solid var(--portal-color);
    color: var(--color-pearl);
    padding: 1rem 2rem;
    font-size: 1.1rem;
    border-radius: 30px;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-bottom: 1rem;
    box-shadow: 0 0 20px var(--portal-color-glow);
    text-shadow: 0 0 10px var(--portal-color-glow);
}

.sacred-button:hover {
    background: linear-gradient(135deg, var(--portal-color-light), var(--portal-color-fade));
    transform: translateY(-2px);
    box-shadow: 0 5px 30px var(--portal-color);
    color: white;
}

.timer {
    font-size: 2.5rem;
    background: linear-gradient(to bottom, var(--portal-color), rgba(51, 153, 255, 0.7));
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    margin: 1rem 0;
    font-family: 'Courier New', monospace;
    text-shadow: 0 0 10px var(--portal-color-glow);
}

.causality-indicator {
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 1rem 0;
}

.causality-chain {
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    justify-content: center;
    gap: 10px;
}

.chain-link {
    padding: 5px 10px;
    border: 1px solid var(--portal-color);
    border-radius: 15px;
    background-color: var(--portal-color-fade);
    color: var(--color-pearl);
    font-size: 0.9rem;
    position: relative;
    transition: all 0.3s ease;
}

.chain-link.active {
    background-color: var(--portal-color-light);
    color: white;
    box-shadow: 0 0 10px var(--portal-color-glow);
}

.chain-arrow {
    color: var(--portal-color);
    font-weight: bold;
}

@media (max-width: 768px) {
    .practice-section {
        grid-template-columns: 1fr;
    }
    
    .principles ul {
        grid-template-columns: 1fr;
    }
    
    .causality-chain {
        flex-direction: column;
    }
    
    .chain-arrow {
        transform: rotate(90deg);
    }
}
</style>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Hexagone de causalité interactif
    const hexagon = document.getElementById('causalityHexagon');
    const causalityLines = document.querySelectorAll('.causality-line');
    const rippleCircle = document.querySelector('.ripple-circle');
    
    hexagon.addEventListener('click', function() {
        this.style.transform = this.style.transform === 'rotate(30deg)' ? 'rotate(0deg)' : 'rotate(30deg)';
        
        // Créer un nouvel effet d'ondulation
        const newRipple = rippleCircle.cloneNode(true);
        document.querySelector('.causality-drops').appendChild(newRipple);
        
        // Supprimer l'effet après l'animation
        setTimeout(() => {
            newRipple.remove();
        }, 4000);
    });
    
    // Animation des lignes de causalité
    function animateCausalityLines() {
        causalityLines.forEach((line, index) => {
            setTimeout(() => {
                line.style.opacity = '1';
                line.style.strokeWidth = '2';
                
                setTimeout(() => {
                    line.style.strokeWidth = '1';
                }, 500);
            }, index * 300);
        });
    }
    
    // Animer les lignes périodiquement
    setInterval(animateCausalityLines, 5000);
    
    // Animation initiale
    animateCausalityLines();

    // Méditation de la cause à l'effet
    const meditationButton = document.getElementById('startMeditation');
    const timer = document.getElementById('timer');
    const chainLinks = document.querySelectorAll('.chain-link');
    let meditationInterval;
    let isMeditating = false;
    let timeLeft = 6 * 60; // 6:00
    let currentLinkIndex = 0;

    meditationButton.addEventListener('click', function() {
        isMeditating = !isMeditating;
        
        if (isMeditating) {
            this.innerHTML = '<i class="fas fa-pause"></i> Pause';
            startMeditation();
        } else {
            this.innerHTML = '<i class="fas fa-play"></i> Reprendre';
            pauseMeditation();
        }
    });

    function startMeditation() {
        meditationInterval = setInterval(() => {
            timeLeft--;
            updateTimer(timer, timeLeft);
            
            // Animer la chaîne de causalité
            if (timeLeft % 15 === 0 || timeLeft === 6 * 60 - 1) {
                updateCausalityChain();
            }
            
            if (timeLeft <= 0) {
                endMeditation();
            }
        }, 1000);
    }
    
    function updateCausalityChain() {
        chainLinks.forEach(link => link.classList.remove('active'));
        
        chainLinks[currentLinkIndex].classList.add('active');
        currentLinkIndex = (currentLinkIndex + 1) % chainLinks.length;
    }

    function pauseMeditation() {
        clearInterval(meditationInterval);
    }

    function endMeditation() {
        clearInterval(meditationInterval);
        meditationButton.innerHTML = '<i class="fas fa-redo"></i> Recommencer';
        isMeditating = false;
        timeLeft = 6 * 60;
        updateTimer(timer, timeLeft);
        chainLinks.forEach(link => link.classList.remove('active'));
        currentLinkIndex = 0;
        new Audio('/static/audio/bell.mp3').play();
    }

    // Exercice
    const exerciseButton = document.getElementById('startExercise');
    const exerciseTimer = document.getElementById('exerciseTimer');
    let exerciseInterval;
    let isExercising = false;
    let exerciseTimeLeft = 4 * 60 + 30; // 4:30

    exerciseButton.addEventListener('click', function() {
        isExercising = !isExercising;
        
        if (isExercising) {
            this.innerHTML = '<i class="fas fa-pause"></i> Pause';
            startExercise();
        } else {
            this.innerHTML = '<i class="fas fa-play"></i> Reprendre';
            pauseExercise();
        }
    });

    function startExercise() {
        exerciseInterval = setInterval(() => {
            exerciseTimeLeft--;
            updateTimer(exerciseTimer, exerciseTimeLeft);
            
            if (exerciseTimeLeft <= 0) {
                endExercise();
            }
        }, 1000);
    }

    function pauseExercise() {
        clearInterval(exerciseInterval);
    }

    function endExercise() {
        clearInterval(exerciseInterval);
        exerciseButton.innerHTML = '<i class="fas fa-redo"></i> Recommencer';
        isExercising = false;
        exerciseTimeLeft = 4 * 60 + 30;
        updateTimer(exerciseTimer, exerciseTimeLeft);
        new Audio('/static/audio/bell.mp3').play();
    }

    // Utilitaire pour formater le temps
    function updateTimer(element, seconds) {
        const minutes = Math.floor(seconds / 60);
        const remainingSeconds = seconds % 60;
        element.textContent = `${minutes}:${remainingSeconds.toString().padStart(2, '0')}`;
    }
});
</script>
{% endblock %} 