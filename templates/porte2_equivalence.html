{% extends "base.html" %}

{% block title %}Porte 2 - Équivalence{% endblock %}

{% block content %}
<div class="portal-page portal-2">
    <header class="portal-header">
        <h1>ÉQUIVALENCE</h1>
        <div class="portal-number">2</div>
        <p class="subtitle">Ce qui est en haut est comme ce qui est en bas</p>
        <p class="principle-quote">« Le miroir ne ment jamais. Il reflète simplement ce qui est. En toi réside l'image du divin. »</p>
    </header>

    <div class="portal-content">
        <div class="wisdom-section">
            <h2>L'Enseignement du Miroir</h2>
            <p>L'Équivalence représente le principe fondamental d'égalité et d'équilibre dans l'univers. C'est la reconnaissance que toute chose trouve son équivalent, son complément, son miroir. Ce principe établit que chaque force, chaque énergie, chaque manifestation trouve son pendant nécessaire.</p>
            
            <div class="sacred-geometry">
                <div class="line-container">
                    <div class="line" id="equivalenceLine">
                        <svg viewBox="0 0 200 20" class="line-symbol">
                            <line x1="10" y1="10" x2="190" y2="10" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
                            <circle cx="10" cy="10" r="5" fill="currentColor"/>
                            <circle cx="190" cy="10" r="5" fill="currentColor"/>
                        </svg>
                    </div>
                    <div class="line-aura"></div>
                </div>
            </div>
            
            <div class="principles">
                <h3>Les Quatre Aspects</h3>
                <ul>
                    <li>La Loi du Miroir</li>
                    <li>L'Harmonie des Sphères</li>
                    <li>L'Unité dans la Dualité</li>
                    <li>Le Reflet Cosmique</li>
                </ul>
            </div>
        </div>

        <div class="practice-section">
            <div class="meditation-card">
                <h2>Méditation du Miroir</h2>
                <p class="meditation-text">Imagine-toi face à un lac parfaitement calme. Ce que tu vois en toi se reflète dans le monde. Inverse la direction. Tu es miroir du divin.</p>
                <div class="meditation-controls">
                    <button id="startMeditation" class="sacred-button">
                        <i class="fas fa-water"></i> Commencer la Méditation
                    </button>
                    <div class="timer-container">
                        <div id="timer" class="timer">02:22</div>
                        <div class="breath-guide">
                            <span class="breath-in">Inspire</span>
                            <span class="breath-pause">•</span>
                            <span class="breath-out">Expire</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="exercise-card">
                <h2>Pratique du Miroir</h2>
                <p class="exercise-text">Observe une situation récente où tu as critiqué quelque chose. Que reflétait-elle en toi ? Note cette équivalence cachée et découvre ce que cette projection t'enseigne sur toi-même.</p>
                <div class="exercise-controls">
                    <button id="startExercise" class="sacred-button">
                        <i class="fas fa-sync-alt"></i> Démarrer l'Exercice
                    </button>
                    <div id="exerciseTimer" class="timer">05:00</div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
:root {
    --portal-color: #FF9933;
    --portal-color-light: rgba(255, 153, 51, 0.3);
    --portal-color-fade: rgba(255, 153, 51, 0.1);
    --portal-color-glow: rgba(255, 153, 51, 0.2);
}

.portal-page {
    max-width: 1000px;
    margin: 0 auto;
    padding: 2rem;
    position: relative;
    background: radial-gradient(circle at center, var(--portal-color-fade) 0%, transparent 70%);
}

.portal-page::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, var(--portal-color-fade) 0%, transparent 50%, var(--portal-color-fade) 100%);
    pointer-events: none;
    z-index: -1;
}

.portal-header {
    text-align: center;
    margin-bottom: 4rem;
    position: relative;
    padding: 2rem;
    background: linear-gradient(to bottom, var(--portal-color-fade), transparent);
    border-radius: 20px;
    box-shadow: 0 0 30px var(--portal-color-glow);
}

.portal-header h1 {
    font-size: 3.5rem;
    background: linear-gradient(to bottom, var(--portal-color), rgba(255, 153, 51, 0.7));
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    margin: 0;
    letter-spacing: 0.5rem;
    font-weight: 400;
    text-shadow: 0 0 20px var(--portal-color-glow);
}

.portal-number {
    font-size: 12rem;
    background: linear-gradient(135deg, var(--portal-color-light), var(--portal-color-fade));
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    position: absolute;
    top: -3rem;
    left: 50%;
    transform: translateX(-50%);
    z-index: -1;
    text-shadow: 0 0 50px var(--portal-color-glow);
}

.subtitle {
    font-size: 1.5rem;
    color: var(--color-pearl);
    margin: 1rem 0;
    font-style: italic;
}

.principle-quote {
    font-size: 1.2rem;
    color: var(--portal-color);
    max-width: 700px;
    margin: 2rem auto;
    font-style: italic;
    line-height: 1.6;
}

.wisdom-section {
    margin-bottom: 4rem;
    text-align: center;
    padding: 2rem;
    background: linear-gradient(to bottom, rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.2));
    border-radius: 20px;
    box-shadow: 0 0 30px rgba(0, 0, 0, 0.3);
    border: 1px solid var(--portal-color-fade);
}

.sacred-geometry {
    height: 200px;
    margin: 3rem 0;
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    background: radial-gradient(circle at center, var(--portal-color-fade) 0%, transparent 70%);
}

.line-container {
    position: relative;
    width: 80%;
    height: 60px;
}

.line {
    position: absolute;
    width: 100%;
    height: 100%;
    color: var(--portal-color);
    cursor: pointer;
    transition: all 0.3s ease;
}

.line:hover {
    transform: scale(1.05);
    filter: brightness(1.2);
}

.line-aura {
    position: absolute;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, var(--portal-color-fade), transparent);
    animation: flow 4s infinite;
}

.principles {
    margin-top: 3rem;
    padding: 2rem;
    background: linear-gradient(135deg, rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.2));
    border-radius: 15px;
    border: 1px solid var(--portal-color-fade);
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
}

.principles h3 {
    color: var(--portal-color);
    margin-bottom: 1.5rem;
    font-size: 1.3rem;
}

.principles ul {
    list-style: none;
    padding: 0;
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem;
}

.principles li {
    color: var(--color-pearl);
    padding: 0.5rem;
    font-size: 1.1rem;
}

.practice-section {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 2rem;
}

.meditation-card, .exercise-card {
    background: linear-gradient(135deg, rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.2));
    border: 1px solid var(--portal-color-fade);
    border-radius: 15px;
    padding: 2rem;
    text-align: center;
    box-shadow: 0 0 30px rgba(0, 0, 0, 0.3);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.meditation-card:hover, .exercise-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 5px 40px var(--portal-color-glow);
}

.meditation-card h2, .exercise-card h2 {
    color: var(--portal-color);
    font-size: 1.5rem;
    margin-bottom: 1.5rem;
}

.meditation-text, .exercise-text {
    color: var(--color-pearl);
    font-size: 1.1rem;
    line-height: 1.6;
    margin-bottom: 2rem;
}

.sacred-button {
    background: linear-gradient(135deg, var(--portal-color-light), var(--portal-color-fade));
    border: 1px solid var(--portal-color);
    color: var(--color-pearl);
    padding: 1rem 2rem;
    font-size: 1.1rem;
    border-radius: 30px;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-bottom: 1rem;
    box-shadow: 0 0 20px var(--portal-color-glow);
    text-shadow: 0 0 10px var(--portal-color-glow);
}

.sacred-button:hover {
    background: linear-gradient(135deg, var(--portal-color-light), var(--portal-color-fade));
    transform: translateY(-2px);
    box-shadow: 0 5px 30px var(--portal-color);
    color: white;
}

.timer {
    font-size: 2.5rem;
    background: linear-gradient(to bottom, var(--portal-color), rgba(255, 153, 51, 0.7));
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    margin: 1rem 0;
    font-family: 'Courier New', monospace;
    text-shadow: 0 0 10px var(--portal-color-glow);
}

.breath-guide {
    display: flex;
    justify-content: center;
    gap: 1rem;
    color: var(--color-pearl);
    opacity: 0.7;
}

.breath-in.active, .breath-out.active {
    color: var(--portal-color);
    opacity: 1;
}

@keyframes flow {
    0% {
        background-position: -300px 0;
    }
    100% {
        background-position: 300px 0;
    }
}

@media (max-width: 768px) {
    .practice-section {
        grid-template-columns: 1fr;
    }
    
    .principles ul {
        grid-template-columns: 1fr;
    }
}
</style>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Ligne d'équivalence interactive
    const line = document.getElementById('equivalenceLine');
    const lineAura = document.querySelector('.line-aura');
    
    line.addEventListener('click', function() {
        lineAura.style.animation = 'none';
        void lineAura.offsetWidth;
        lineAura.style.animation = 'flow 4s infinite';
    });

    // Méditation
    const meditationButton = document.getElementById('startMeditation');
    const timer = document.getElementById('timer');
    const breathIn = document.querySelector('.breath-in');
    const breathOut = document.querySelector('.breath-out');
    let meditationInterval;
    let isMeditating = false;
    let timeLeft = 15 * 60;

    meditationButton.addEventListener('click', function() {
        isMeditating = !isMeditating;
        
        if (isMeditating) {
            this.innerHTML = '<i class="fas fa-pause"></i> Pause';
            startMeditation();
        } else {
            this.innerHTML = '<i class="fas fa-play"></i> Reprendre';
            pauseMeditation();
        }
    });

    function startMeditation() {
        meditationInterval = setInterval(() => {
            timeLeft--;
            updateTimer(timer, timeLeft);
            
            // Alternance respiration
            if (timeLeft % 8 < 4) {
                breathIn.classList.add('active');
                breathOut.classList.remove('active');
            } else {
                breathIn.classList.remove('active');
                breathOut.classList.add('active');
            }
            
            if (timeLeft <= 0) {
                endMeditation();
            }
        }, 1000);
    }

    function pauseMeditation() {
        clearInterval(meditationInterval);
    }

    function endMeditation() {
        clearInterval(meditationInterval);
        meditationButton.innerHTML = '<i class="fas fa-redo"></i> Recommencer';
        isMeditating = false;
        timeLeft = 15 * 60;
        updateTimer(timer, timeLeft);
        new Audio('/static/audio/bell.mp3').play();
    }

    // Exercice
    const exerciseButton = document.getElementById('startExercise');
    const exerciseTimer = document.getElementById('exerciseTimer');
    let exerciseInterval;
    let isExercising = false;
    let exerciseTimeLeft = 3 * 60;

    exerciseButton.addEventListener('click', function() {
        isExercising = !isExercising;
        
        if (isExercising) {
            this.innerHTML = '<i class="fas fa-pause"></i> Pause';
            startExercise();
        } else {
            this.innerHTML = '<i class="fas fa-play"></i> Reprendre';
            pauseExercise();
        }
    });

    function startExercise() {
        exerciseInterval = setInterval(() => {
            exerciseTimeLeft--;
            updateTimer(exerciseTimer, exerciseTimeLeft);
            
            if (exerciseTimeLeft <= 0) {
                endExercise();
            }
        }, 1000);
    }

    function pauseExercise() {
        clearInterval(exerciseInterval);
    }

    function endExercise() {
        clearInterval(exerciseInterval);
        exerciseButton.innerHTML = '<i class="fas fa-redo"></i> Recommencer';
        isExercising = false;
        exerciseTimeLeft = 3 * 60;
        updateTimer(exerciseTimer, exerciseTimeLeft);
        new Audio('/static/audio/bell.mp3').play();
    }

    // Utilitaire pour formater le temps
    function updateTimer(element, seconds) {
        const minutes = Math.floor(seconds / 60);
        const remainingSeconds = seconds % 60;
        element.textContent = `${minutes}:${remainingSeconds.toString().padStart(2, '0')}`;
    }
});
</script>
{% endblock %} 